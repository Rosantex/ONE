// by Rosantex

<script type="text/javascript">

var Url = 'https://raw.githubusercontent.com/Rosantex/my/master/';
var wBox = readUrl(Url + 'En') + readUrl(Url + 'Ko');
var db;

var xTalk = $('#Talk'),
    xTake = $('#ChatBtn'),
     xDsp = $("div[class='jjo-display ellipse']"),
    xTime = $("div[class='graph jjo-turn-time']"),
    xTurn = $('.game-input'),
   xRound = $("div[class='rounds']"),
    xItem = $("div[class='items']");

pTime(true);

function wPrint() { 
if (xTurn.css('display') == 'none') return; 
pTime(false); 
var n = 1;
var reg;
var wd = '';
var m = xItem.text();
var f = xDsp.text(); 
f = ( f.includes('(') ? '(' + f.replace('(', '|') : f.includes(':') ? pf : f ); 
var _Found = true;
var _LFound = db.match("\\[(" + f + ".*)\\]")[0];

while ( _Found ) {
reg = '\\[' + f + '(.*' + m + '){' + n + ',}\\]';
wd = db.match(reg);
    if ( wd ) {
    pf = f;
    _LFound = wd[0];
  n = _LFound.split(m).length;
    } else {
       return;
    }
}

if ( _LFound ) {
xTalk.val(_LFound.slice(1, -1)); 	
xTake.click(); 	
db = db.replace(_LFound, '');
sleep(40);
}
pTime(true);
}

function pTime(plug) {
var e = 'DOMSubtreeModified';
plug ? xTime.on(e, wPrint) : xTime.off(e);
}

xRound.on('DOMSubtreeModified', function() {
        if ( db != wBox ) {
	        db = wBox;
	}
});

function readUrl(Url) {
	return $.ajax({ type: "GET", url: Url, async: false }).responseText; 
}

function sleep(delay) { 
var start = new Date().getTime(); 
while (new Date().getTime() < start + delay); 
}

</script>
